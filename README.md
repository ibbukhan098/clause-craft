# ClauseCraft – AI Contract Generator & Analyzer

A modern React app to generate contracts with LLMs and analyze clauses for risk. Contracts are generated via Supabase Edge Functions calling Hugging Face Router chat completions. Contracts and analyses are stored locally (browser `localStorage`) so anyone can use the app without auth.

## Features

- **Generate contracts** from a freeform prompt or questionnaire
- **Reliable parsing** of AI output into structured clauses (title + sections)
- **Analyze with AI** per clause with concise, actionable “Key insight”
- **Risk assessment** badges per clause and overall average for the contract
- **Reanalyze All** button to refresh risk across the whole document
- **Edit inline** with history undo/redo and export to `.txt`

## Architecture

- Frontend: Vite + React + TypeScript + Tailwind + shadcn-ui
- Storage: Client-side `localStorage` (no auth required)
- AI backend: Supabase Edge Functions (Deno) that call Hugging Face Router `v1/chat/completions`
- Models: Priority order favors accessible high‑quality instruct models

## Getting Started (Local)

1) Clone & install
```bash
git clone <your-repo-url>
cd <your-repo-name>
npm install
```

2) Supabase (Edge Functions) setup
- In Supabase Project → Functions, set environment variable:
  - `HUGGING_FACE_ACCESS_TOKEN` (with access to your chosen models)
- Deploy/update the two functions from `supabase/functions/` if needed.

3) Run the app
```bash
npm run dev
```
Open `http://localhost:5173` (Vite default) or the URL shown in your terminal.

## Environment Variables (Frontend)

If you prefer not to hardcode Supabase keys, create `.env.local` and use Vite vars instead:
```
VITE_SUPABASE_URL=https://<your-project>.supabase.co
VITE_SUPABASE_ANON_KEY=<your-anon-key>
```
Update `src/integrations/supabase/client.ts` to read from `import.meta.env`.

## Usage Flow

1) From Home, choose to generate via prompt or questionnaire
2) You’ll be taken to the Draft page while the contract is generated by the edge function
3) The contract is parsed into clauses with types (Parties, Purpose & Scope, Terms & Conditions, etc.)
4) Click the sparkles icon on any clause to “Analyze with AI”
   - Returns a concise 1–2 sentence “Key insight” and risk score
   - Risk badge thresholds are inclusive: `<= 0.3` Low, `<= 0.7` Medium, else High
5) Use “Reanalyze All” in the sidebar to update every clause’s risk and recompute overall
6) Edit clauses inline (undo/redo supported) and export to `.txt`

## Risk Scoring

Both generation and analysis share the same risk scoring heuristics to ensure stability when re-analyzing unchanged text. Overall risk is the average of clause risk scores (capped to 1.0).


## Project Structure

```
src/
├── components/
│   └── ai/ContractAnalyzer.tsx         # Client wrapper for analyze edge function
├── hooks/
│   └── useContracts.ts                 # Local storage for contracts + analyses
├── pages/
│   ├── Index.tsx                       # Landing / prompt flow
│   └── Draft.tsx                       # Editor, AI analysis, risk sidebar
└── integrations/supabase/
    ├── client.ts                       # Supabase client
    └── types.ts                        # DB types (not used for local storage)

supabase/functions/
├── analyze-contract/index.ts           # Calls HF Router for clause analysis
└── generate-contract/index.ts          # Calls HF Router for generation + parsing
```
